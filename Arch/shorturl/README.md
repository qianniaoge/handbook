设计一个短链接服务。如何抗住大qps， 抗大流量 。url 哈希函数怎么设计（怎么存，怎么统计qps）


除了对需求背景 功能需求 非功能需求 扩展需求进行分析外

还有流量估算(QPS，读请求/写请求估算) 容量估算 带宽估算 内存估算(缓存)

算法部分：短链如何生成的方法

- 自增id
- 哈希算法
- 普通随机数

需要考虑数据怎么存储 缓存怎么设计

缓存方案

查询需求
个人认为对于几百个G的数据量都放在缓存肯定是不合适的，所以有个折中的方案：将最近3个月内有查询或者有新增的url放入缓存，使用LRU算法进行热更新。这样最近有使用的发概率会命中缓存，就不用走库。查不到的时候再走库更新缓存。

新增需求
对于新增的链接就先查缓存是否存在，缓存不存在再查库，数据库已经分表了，查询的效率也不会很低。

缓存的设计
查询的需求是用户拿着短链查询对应的真实地址，那么缓存的key只能是短链，可以使用 KV的形式存储。
